USE [master]

GO

CREATE SERVER AUDIT [Audit_all_data_change]
TO FILE 
(	FILEPATH = N'e:\audit\'
	,MAXSIZE = 1000 MB
	,MAX_ROLLOVER_FILES = 30
	,RESERVE_DISK_SPACE = OFF
)
WITH
(	QUEUE_DELAY = 5000
	,ON_FAILURE = CONTINUE
)

GO

CREATE SERVER AUDIT [Audit-CallCenter_Login_Logout]
TO FILE 
(	FILEPATH = N'e:\audit\'
	,MAXSIZE = 2000 MB
	,MAX_ROLLOVER_FILES = 400
	,RESERVE_DISK_SPACE = OFF
)
WITH
(	QUEUE_DELAY = 5000
	,ON_FAILURE = CONTINUE
)

GO

CREATE SERVER AUDIT [CallCenter_Permission_Change]
TO FILE 
(	FILEPATH = N'e:\audit\'
	,MAXSIZE = 200 MB
	,MAX_ROLLOVER_FILES = 1
	,RESERVE_DISK_SPACE = OFF
)
WITH
(	QUEUE_DELAY = 5000
	,ON_FAILURE = CONTINUE
)

GO



USE [CallCenter]

GO

CREATE DATABASE AUDIT SPECIFICATION [All_Login_Logout]
FOR SERVER AUDIT [Audit_all_data_change]
ADD (FAILED_DATABASE_AUTHENTICATION_GROUP),
ADD (DATABASE_LOGOUT_GROUP),
ADD (SUCCESSFUL_DATABASE_AUTHENTICATION_GROUP)

GO

CREATE DATABASE AUDIT SPECIFICATION [Permission_Change]
FOR SERVER AUDIT [CallCenter_Permission_Change]
ADD (DATABASE_ROLE_MEMBER_CHANGE_GROUP),
ADD (DATABASE_PERMISSION_CHANGE_GROUP),
ADD (DATABASE_OBJECT_PERMISSION_CHANGE_GROUP),
ADD (SCHEMA_OBJECT_PERMISSION_CHANGE_GROUP),
ADD (DATABASE_PRINCIPAL_IMPERSONATION_GROUP),
ADD (DATABASE_CHANGE_GROUP),
ADD (DATABASE_OBJECT_CHANGE_GROUP),
ADD (DATABASE_PRINCIPAL_CHANGE_GROUP),
ADD (SCHEMA_OBJECT_CHANGE_GROUP),
ADD (DATABASE_OPERATION_GROUP),
ADD (DATABASE_OWNERSHIP_CHANGE_GROUP),
ADD (DATABASE_OBJECT_OWNERSHIP_CHANGE_GROUP),
ADD (SCHEMA_OBJECT_OWNERSHIP_CHANGE_GROUP)

GO

CREATE DATABASE AUDIT SPECIFICATION [Privileged_User_Change_Data]
FOR SERVER AUDIT [Audit_all_data_change]
ADD (DELETE ON DATABASE::[CallCenter] BY [public]),
ADD (EXECUTE ON DATABASE::[CallCenter] BY [public]),
ADD (INSERT ON DATABASE::[CallCenter] BY [public]),
ADD (UPDATE ON DATABASE::[CallCenter] BY [public])

GO
